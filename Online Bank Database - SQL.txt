/*
Online Bank Database Project

Nicole Jacobo
Paul Lombard
Folly Adamazan Teko
Mohamed Abdi
Dego Mohamed
Claude Lee

*/


/*Create Tables*/

CREATE TABLE BANK (
BANK_ID    NUMBER     PRIMARY KEY NOT NULL,
BANK_NAME       VARCHAR(15) NOT NULL,
BANK_ADDR       VARCHAR(35) NOT NULL,
BANK_ZIP        NUMBER(5)     NOT NULL,
BANK_AREACODE   CHAR(3)     NOT NULL,
BANK_PHONE      CHAR(8)     NOT NULL);

CREATE TABLE DEPARTMENT (​
DEPART_ID       NUMBER  PRIMARY KEY NOT NULL,​
DEPART_NAME     VARCHAR(15)     NOT NULL,​
BANK_ID         NUMBER          NOT NULL,​
FOREIGN KEY (BANK_ID) REFERENCES BANK);

CREATE TABLE EMPLOYEE (
EMP_ID     NUMBER    PRIMARY KEY NOT NULL,
EMP_FNAME   VARCHAR(15) NOT NULL,
EMP_LNAME   VARCHAR(15) NOT NULL,
EMP_INITIAL CHAR(1),
EMP_HIREDATE DATE,
JOB_TITLE    VARCHAR(25),
DEPART_ID   NUMBER,
FOREIGN KEY (DEPART_ID) REFERENCES DEPARTMENT);

CREATE TABLE CUSTOMER (
CUS_ID      NUMBER     PRIMARY KEY NOT NULL,  
CUS_LNAME       VARCHAR(15) NOT NULL,  
CUS_FNAME       VARCHAR(15) NOT NULL,  
CUS_INITIAL     CHAR(1),  
CUS_AREACODE    CHAR(3),
CUS_PHONE        CHAR(8),
BANK_ID           NUMBER,
FOREIGN KEY (BANK_ID) REFERENCES BANK);

CREATE TABLE BANK_ACCOUNT (
ACCT_NUM    NUMBER   PRIMARY KEY NOT NULL,
ACCT_TYPE       VARCHAR(10) NOT NULL,
ACCT_BAL        NUMBER(10,2) NOT NULL,
OPEN_DATE       DATE,
ACTIV_STATUS    VARCHAR(10) NOT NULL);

CREATE TABLE ASSIGNMENT (
ASSIGN_CODE  NUMBER  PRIMARY KEY NOT NULL,
CUS_ID            NUMBER,
ACCT_NUM        NUMBER,
FOREIGN KEY       (CUS_ID) REFERENCES CUSTOMER,
FOREIGN KEY       (ACCT_NUM) REFERENCES BANK_ACCOUNT);   

CREATE TABLE CARD (
CARD_NUM    NUMBER(16)   PRIMARY KEY NOT NULL,
CARD_TYPE     VARCHAR(10) NOT NULL,
ISSUE_DATE    DATE,
EXPIR_DATE    DATE,
CARD_PIN       NUMBER(4)      NOT NULL,
ASSIGN_CODE        NUMBER,
FOREIGN KEY        (ASSIGN_CODE) REFERENCES ASSIGNMENT);


/*Entries for each entity*/

/*Bank Entry*/
INSERT INTO BANK VALUES (123, 'GROUP 3 BANK','720 4TH AVE S',
56301, '678','999-8212');

/*Department Entries*/
INSERT INTO DEPARTMENT VALUES (001,'Retail',123);
INSERT INTO DEPARTMENT VALUES (002,'Lending',123);
INSERT INTO DEPARTMENT VALUES (003,'Loan Operations',123);
INSERT INTO DEPARTMENT VALUES (004,'Private Bank',123);
INSERT INTO DEPARTMENT VALUES (005,'Corporate Bank',123);
INSERT INTO DEPARTMENT VALUES (006,'Treasury',123);
INSERT INTO DEPARTMENT VALUES (007,'Credit Risk',123);
INSERT INTO DEPARTMENT VALUES (008,'Finance',123);
INSERT INTO DEPARTMENT VALUES (009,'HR',123);
INSERT INTO DEPARTMENT VALUES (010,'Adminisration',123);

/*Employee Entries*/
INSERT INTO EMPLOYEE VALUES (12345,'Adam','Thielen','J','20-JAN-2016','Teller',001);
INSERT INTO EMPLOYEE VALUES (23456,'Kirk','Cousins','A','20-FEB-2018','Loan Officer',002);
INSERT INTO EMPLOYEE VALUES (34567,'Joe','Mauer','J','20-JAN-2001','Loan Supervisor',003);
INSERT INTO EMPLOYEE VALUES (45678,'Justin','Jefferson','D','20-APR-2020','Financial Advisor',004);
INSERT INTO EMPLOYEE VALUES (56789,'Tom','Brady','P','20-JAN-2000','Business Lending',005);
INSERT INTO EMPLOYEE VALUES (67891,'Michael','Jordan','J','20-JAN-1984','Accounting',006);

/*Customer Entries*/
INSERT INTO CUSTOMER VALUES(1, 'Lombard', 'Paul', 'L', '320', '767-9575', 123);
INSERT INTO CUSTOMER VALUES(2, 'Lee', 'Claude', '', '320', '435-5978', 123);
INSERT INTO CUSTOMER VALUES(3, 'Mohamed', 'Dego', '', '507', '395-4893', 123);
INSERT INTO CUSTOMER VALUES(4, 'Mohamed', 'abdi', 'M', '789', '456-9803', 123);
INSERT INTO CUSTOMER VALUES(5, 'Adamazan teko', 'folly', '', '507', '375-9845', 123);
INSERT INTO CUSTOMER VALUES(6, 'Jacobo', 'Nicole', 'N', '320', '487-8946', 123);
INSERT INTO CUSTOMER VALUES(7, 'John', 'Doe', '', '750', '574-7909', 123);
INSERT INTO CUSTOMER VALUES(8, 'Jane', 'Doe', '', '869', '679-8943', 123);
INSERT INTO CUSTOMER VALUES(9, 'Ashey', 'Cole', 'C', '507', '689-7890',123);
INSERT INTO CUSTOMER VALUES(10, 'Abigail', 'Ayoko', '', '700', '345-8983', 123);

/*Bank Account Entries*/
INSERT INTO BANK_ACCOUNT VALUES(922404,'TRADIRA',86336.41,'24-JAN-1996','ACTIVE');
INSERT INTO BANK_ACCOUNT VALUES(599364,'SAVINGS',165.54,'14-OCT-2018','ACTIVE');
INSERT INTO BANK_ACCOUNT VALUES(260080,'SAVINGS',6393.48,'4-JAN-2006','ACTIVE');
INSERT INTO BANK_ACCOUNT VALUES(169609,'CHECKING',1303.82,'30-MAR-1995','ACTIVE');
INSERT INTO BANK_ACCOUNT VALUES(742833,'CHECKING',-359.65,'18-FEB-2014','OVERDRAWN');
INSERT INTO BANK_ACCOUNT VALUES(333390,'SAVINGS',49.32,'11-MAR-2002','INACTIVE');
INSERT INTO BANK_ACCOUNT VALUES(755869,'HSA',741.05,'29-NOV-2014','ACTIVE');
INSERT INTO BANK_ACCOUNT VALUES(551836,'SAVINGS',121620.68,'21-AUG-2006','ACTIVE');
INSERT INTO BANK_ACCOUNT VALUES(795894,'CHECKING',-12.92,'19-DEC-2018','OVERDRAWN');
INSERT INTO BANK_ACCOUNT VALUES(181260,'CHECKING',439.81,'25-FEB-2019','ACTIVE');

/*Assignment Entries*/
INSERT INTO ASSIGNMENT VALUES(1, 1, 922404);
INSERT INTO ASSIGNMENT VALUES(2, 1, 599364);
INSERT INTO ASSIGNMENT VALUES(3, 2, 260080);
INSERT INTO ASSIGNMENT VALUES(4, 3, 169609);
INSERT INTO ASSIGNMENT VALUES(5, 4, 169609);
INSERT INTO ASSIGNMENT VALUES(6, 5, 169609);
INSERT INTO ASSIGNMENT VALUES(7, 6, 742833);
INSERT INTO ASSIGNMENT VALUES(8, 7, 742833);
INSERT INTO ASSIGNMENT VALUES(9, 8, 333390);
INSERT INTO ASSIGNMENT VALUES(10, 8, 181260);
INSERT INTO ASSIGNMENT VALUES(11, 9, 181260);
INSERT INTO ASSIGNMENT VALUES(12, 9, 755869);
INSERT INTO ASSIGNMENT VALUES(13, 10, 551836);
INSERT INTO ASSIGNMENT VALUES(14, 10, 795894);

/*Card Entries*/
INSERT INTO CARD VALUES(4243507034864858, 'Debit', '22-OCT-2018', '23-OCT-2022', 1234, 1);
INSERT INTO CARD VALUES(4243507034863858, 'Debit', '22-OCT-2010', '23-OCT-2014', 1534, 2);
INSERT INTO CARD VALUES(4243507034862858, 'Credit', '22-OCT-2014', '23-OCT-2018', 1274, 3);
INSERT INTO CARD VALUES(4243507034865858, 'ATM', '22-OCT-2012', '22-OCT-2016', 2234, 4);
INSERT INTO CARD VALUES(4243407034864858, 'Credit', '22-OCT-2016', '23-OCT-2020', 6244, 5);
INSERT INTO CARD VALUES(4243507134865858, 'ATM', '22-OCT-2006', '23-OCT-2010', 4334, 6);
INSERT INTO CARD VALUES(4142507034864858, 'Debit', '22-JAN-2018', '23-JAN-2022', 8834, 7);
INSERT INTO CARD VALUES(4142507134865858, 'Credit', '2-FEB-2014', '3-FEB-2018', 6666, 8);
INSERT INTO CARD VALUES(4243570034864858, 'Debit', '06-JUN-2018', '07-JUN-2022', 1294, 9);
INSERT INTO CARD VALUES(4243507034864059, 'Credit', '22-OCT-2020', '23-OCT-2024', 1010, 10);


/*Queries*/

/*
Query 1
We would like to encourage customers to open Checking Accounts. In order to target marketing efforts, we need to find all Customers who do not have Checking Accounts.  
*/
SELECT CUS_LNAME, CUS_FNAME, ACCT_TYPE, BANK_ACCOUNT.ACCT_NUM
FROM CUSTOMER, ASSIGNMENT, BANK_ACCOUNT
WHERE CUSTOMER.CUS_ID = ASSIGNMENT.CUS_ID
AND BANK_ACCOUNT.ACCT_NUM = ASSIGNMENT.ACCT_NUM
AND BANK_ACCOUNT.ACCT_TYPE != 'CHECKING';

/*
Query 2
We would like to inform customers whose cards have been expired. To be able to obtain the list of those customers, we need to find all cards that have been expired and pull the assigned customer information.
*/
SELECT CUS_LNAME, CUS_FNAME, CUS_INITIAL, CUS_AREACODE, CUS_PHONE, CARD_NUM
FROM CUSTOMER, ASSIGNMENT, CARD
WHERE CUSTOMER.CUS_ID = ASSIGNMENT.CUS_ID
AND ASSIGNMENT.ASSIGN_CODE = CARD.ASSIGN_CODE
AND CARD.EXPIR_DATE >= ‘09-DEC-2020’;

/*
Query 3
We would like to see accounts that are not active, and the customers associated with those accounts
*/
SELECT CUS_LNAME, CUS_FNAME, CUS_PHONE, BANK_ACCOUNT.ACCT_NUM, ACTIV_STATUS
FROM CUSTOMER, BANK_ACCOUNT, ASSIGNMENT
WHERE CUSTOMER.CUS_ID = ASSIGNMENT.CUS_ID
AND BANK_ACCOUNT.ACCT_NUM = ASSIGNMENT.ACCT_NUM
AND BANK_ACCOUNT.ACTIV_STATUS != 'ACTIVE';


